DROP DATABASE IF EXISTS curso_db;
CREATE DATABASE curso_db;
USE curso_db;

DROP TABLE IF EXISTS estado;
CREATE TABLE estado (
id INT PRIMARY KEY AUTO_INCREMENT
,nome VARCHAR(200) NOT NULL UNIQUE							/*	constraint inline	**/
,sigla CHAR (2) NOT NULL UNIQUE
,ativo CHAR (1) NOT NULL	DEFAULT ('S')
,data_cadastro DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP
,CHECK (ativo IN ('S', "N"))								/*	constraint outline	**/
,CONSTRAINT estado_ativo_S_ou_N CHECK (ativo IN ('S', 'N'))
);

INSERT INTO estado (nome, sigla, ativo) VALUES ('PARANÁ', 'PR', 'S');
-- INSERT INTO estado (id, nome, sigla, ativo, data_cadastro) VALUES (2,'PARANÁ', 'PR', 'S','2022-09-03');
INSERT INTO estado (nome, sigla, ativo) VALUES ('SÃO PAULO', 'SP', 'S');

SELECT id, nome, sigla, ativo, data_cadastro FROM estado;

DROP TABLE IF EXISTS cidade;
CREATE TABLE cidade (
id INT PRIMARY KEY AUTO_INCREMENT
,nome VARCHAR(200) NOT NULL UNIQUE							/*	constraint inline	**/
,ativo CHAR (1) NOT NULL	DEFAULT ('S')
,data_cadastro DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP
,estado_id INT NOT NULL
,CONSTRAINT fk_cidade_estado FOREIGN KEY (estado_id) REFERENCES estado (id)
,CONSTRAINT cidade_ativo_S_ou_N CHECK (ativo IN ('S', 'N'))
,CONSTRAINT cidade_unica UNIQUE(nome, estado_id)
);

INSERT INTO cidade (nome, estado_id) VALUES ('CURITIBA',1);
INSERT INTO cidade (nome, estado_id) VALUES ('PARANAVAI',1);
INSERT INTO cidade (nome, estado_id) VALUES ('LONDRINA',1);

SELECT * FROM cidade;

/* 
ALTERAÇÕES NAS TABELAS
Caso ainda não estiver na produção, faça as alterações direto na tabela
Se a base de dados já está na produção, precisa-se utilizar o ALTER -> cuidado!!!
**/

ALTER TABLE estado	ADD COLUMN	 regiao INT;

SELECT * FROM estado;
DESCRIBE estado;
DESC estado;
ALTER TABLE	estado CHANGE regiao regiao_estado VARCHAR (100) NOT NULL;
ALTER TABLE estado	MODIFY COLUMN regiao VARCHAR(100) NOT NULL;
ALTER TABLE estado DROP COLUMN regiao;
ALTER TABLE estado DROP CONSTRAINT estado_ativo_S_ou_N;


ALTER TABLE estado MODIFY COLUMN ativo ENUM('S','N') NOT NULL;
INSERT INTO estado (nome, sigla, ativo) VALUES ('MATO GROSSO', 'MT', 'A');   -- Vai gerar erro por causa do novo enum 

/** ESSES SÃO OS COMANDOS DDL
    DDL -> Date DEFINITION language 
    CREATE/ALTER/DROP TABLE
    ALTER TABLE ADD/DROP/MODIFY/CHANGE
**/

-- aula sobre padrões ---
